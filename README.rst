# reRoute_Dynamics - A Battery-Electric Bus Simulaton Toolkit
---
## About
---
reRoute_Dynamics is a software package that is a more thourouglhly refined version of [Route_Dynamics](https://github.com/EricaEgg/Route_Dynamics). Its intention is to provide the tools and framework needed to estimate energy demand for a battery-electric bus (or other vehicle) provided adequate geospatial and conditional data. 

## Sebastian's To Do List: 
1/8/2025: 
- Write Tests for Physics_Engine.py, this is a top priority to show this works adequately - Done! 1/16/2025
- Write tests for Geography_Tools.py - Done! 1/16/2025
- Write tests for instance_tools.py - Done! 1/16/2025
- ~~Write tests for trip_simulator? may not be possible~~ Noooope. 1/16/2025
- Get an example notebook set up to run a whole bunch of runs and export relevant data. Adapt the existing KC tools.
- Write a better ESS method so as to be able to predict voltage. This will involve a literature review. Remember the eventual goal is disaggregation of route vs decay. Voltage is just one metric. 
- Create more Trips, busses, and ESS options beyond the XDE35.
- Collect data sources and parameter sources into one document, might want to do tables
- Maybe write some more examples beyond the tests, !!!for individual routes!!!
- Do we want to be able to export ALL the information about a given trip? If so, how do we encode it? 
Eventual Goals:
- Test on Portland metro.

## Dependencies
---
To Do: Hahahahaha Not Yet

## Repository Structure
---
- src: Contains primary directories for packages
  - reRoute_Dynamics_Core: Contains the primary .py files used in the toolkit for modeling.
    - ESS.py - Python file containing methods for the Energy Storage System and its corresponding calculations
    - Geography_Tools.py - Python file used for most geospatial data loading and calculation. Includes Raster handling.
    - Instance_Tools.py - Python file used for helping interperet Route() objects from Geography_Tools.py and preparing them for use in Trip_Simulator.py.
    - Object_Params.py - Python file that is used for generating and saving object classes like Trips, Busses, and ESS's. 
    - Physics_Engine.py - Python file that handles most of the physics calculations of a given trip, including braking, accelerating, and maintaing speed. 
    - Trip_Simulator.py - Python file that acts as a script to run a given Bus() with a given ESS() on a given Trip().
- Examples: Contains example scripts, files, and notebooks.
    - KC_Example_Data: Contains example data that can be used for running simulated trips. 
        - Acceleration_Profiles: directory that contains possible acceleration profiles.
            - Erica_Acceleration.csv - This file is an example acceleration profile (First column in seconds, second in g's) that was used by Erica in the original version. It was interpolated from data provided by King County Metro, but that data and its source is no longer available.
            - Braunschweig_Acceleration.csv - This file is an example acceleration profile (First column in seconds, second in g's) that was generated by aggregating the accelerations shown in the [Braunshcweig Driving Cycle provided by NREL](https://web.archive.org/web/20241128131551/https://www.nrel.gov/transportation/drive-cycle-tool/)
        - Example_Raster_Data: directory that would contain raster data from [King County West's 2021 DTM Survey](https://lidarportal.dnr.wa.gov/) at https://lidarportal.dnr.wa.gov/, but it's too large. See enclosed note in /KC_West_2021/dtm/.
        - Example_Route_Data: directory that holds handmade CSV's for routes stops and road points.
        - KC_Route_Data: Contains Ridership Data from Erica's work with King County (Source Unknown), [Street Geodata](https://gis-kingcounty.opendata.arcgis.com/datasets/3936d3ad103945aabd7b0261afa0686d_394/explore?location=47.643846%2C-122.114739%2C15.43), [Signal Geodata](https://gis-kingcounty.opendata.arcgis.com/search?q=signals&tags=transportation_OpenData), and information from [King County's GTFS Feed](https://kingcounty.gov/en/dept/metro/rider-tools/mobile-and-web-apps#toc-developer-resources)
        - KC_Survey_Benchmarks: Contains King County Survey Benchmarks from [NOAA's National Geodetic Survey Database](https://www.ngs.noaa.gov/datasheets/)
        
        - Example_Route_Save: Directory that contains example json savefiles for Route objects.
        - Misc: directory that contains images to be displayed in example notebooks.
        - Saved_Objects: directory that holds example saved objects as produced by Object_Tools.py.
        - Saved_Routes: directory that holds example saved Routes() as produced by Geography_Tools.py
    - KC_Query_Tools.py - Python file used for querying the King-County-specific information
    - KC_Route_Testing.py - Python file that is used and contains the methods for testing King-County-specific bus routes.
    - King_County_BEV_Sim.ipynb - Jupyter Notebook that contains a brief example on using KC_Query_Tools.py and KC_Route_Testing.py, as well as Object_Methods.py.
- Tests: Contains tests and testing materials for methods in src.

## Examples
---
To Do. 

## Credits:
### Author: Sebastian Peck
### Advisor: Dr. Daniel T. Schwartz
### Original Concept + Core ideas: Dr. Erica Eggleton


## Misc 
---
https://gis-kingcounty.opendata.arcgis.com/maps/284a6b7a12a04016ab8b754e3b354e47
